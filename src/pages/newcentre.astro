---
import OIACLayout from "../layouts/oiac-layout.astro";
import interacLogo from "../assets/Interac.Logo1.png";
import InfiniteCarousel from "../components/InfiniteCarousel.astro";
import Announcements from "../components/Announcements.astro";
import { getNewCentreUpdates } from "../lib/content/newcentre-updates";

const updates = await getNewCentreUpdates();

function formatDate(dateString: string): string {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<OIACLayout title="OIAC - New Centre">
  <div class="px-4 p-2 md:px-8 md:py-2 mx-auto text-gray-800">
    <div class="container mt-5 mb-10">
      <InfiniteCarousel />
      <Announcements />

      <div class="p-10 mt-5 bg-terracottaRed rounded-2xl">
        <h4 class="text-4xl font-black text-softBeige">
          New Omar Ibn Al Khattab Centre
        </h4>
        <div class="py-5 text-softBeige-lightest">
          <p class="mb-3">
            For years, the Omar bin-al-Khattab centre has been the heart of our
            community. A place of worship, learning and connection. But as our
            community grows, so do our needs. The current centre, though vibrant
            and full of life, is bursting at the seams. We have reached a point
            of saturation where our beloved centre can no longer adequately
            serve the needs of our expanding community. However, there is hope
            in the horizon.
          </p>
          <p class="mb-3">
            Introducing the new Omar bin-al-Khattab centre, a beacon of progress
            and possibility. This purpose-built facility will be more than just
            a building. It will be a hub of activity. A place where our children
            can learn and grow, where families can come together in prayer and
            fellowship and where the bonds of community are strengthened.
          </p>
          <p class="mb-3">
            But we can't do this alone. We need your help to turn this vision
            into reality. Together we can build a centre that not only meets the
            needs of today, but anticipates the needs of tomorrow.
          </p>
          <p class="mb-3">
            Donate now and be a part of something truly transformative,
            empowering our community, building our future.
          </p>

          <div class="flex-row mt-10">
            <div>
              <a
                href="/donatetonewcentre"
                class="bg-softBeige-lightest hover:bg-softBeige-lighter text-terracottaRed text-2xl rounded-xl px-24 py-2"
                >Donate</a
              >
            </div>

            <div class="flex gap-3 py-8">
              <img src={interacLogo.src} width="40px" alt="Interac" />
              <div
                class="font-bold bg-sageGreen text-gray-50 rounded-lg text-center mt-3 w-fit px-3"
              >
                <span>new.project@oiacedmonton.ca</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      {updates.map((update) => (
        <div class="p-5 border-b border-gray-500 mb-2">
          <div class="p-5">
            <h4 class="text-4xl font-black">{update.title}</h4>
            <label class="px-3 bg-sageGreen text-white rounded-xl">
              {formatDate(update.date)}
            </label>
            {update.description && (
              <p class="mt-3 text-gray-700" set:html={update.description} />
            )}
          </div>
          <div class="p-5 space-y-6">
            {/* Video Section - show if videoUrl exists */}
            {update.videoUrl && (
              <div style="position:relative; width:100%; height:0px; padding-bottom:56.250%">
                <iframe
                  allow="fullscreen"
                  allowfullscreen
                  height="100%"
                  src={update.videoUrl}
                  width="100%"
                  style="border:none; width:100%; height:100%; position:absolute; left:0px; top:0px; overflow:hidden;"
                  class="rounded-xl"
                />
              </div>
            )}

            {/* Images Section - show if images exist */}
            {update.images && update.images.length > 0 && (
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {update.images.map((image) => (
                  <img
                    src={image.url}
                    alt={update.title}
                    class="rounded-xl w-full h-auto object-cover"
                  />
                ))}
              </div>
            )}

            {/* Links Section - show if links exist */}
            {update.links && update.links.length > 0 && (
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {update.links.map((link) => (
                  <a
                    href={link.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="block p-4 bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl hover:shadow-lg transition group"
                  >
                    <div class="flex items-start gap-3">
                      <div class="text-2xl text-blue-500 group-hover:scale-110 transition">
                        ðŸ”—
                      </div>
                      <div class="flex-1">
                        <h5 class="font-semibold text-blue-800 group-hover:text-blue-600 transition">
                          {link.title}
                        </h5>
                        {link.description && (
                          <p class="text-sm text-gray-600 mt-1">
                            {link.description}
                          </p>
                        )}
                        <span class="text-xs text-blue-500 mt-2 inline-block">
                          Click to view â†’
                        </span>
                      </div>
                    </div>
                  </a>
                ))}
              </div>
            )}
          </div>
        </div>
      ))}
    </div>
  </div>
</OIACLayout>
